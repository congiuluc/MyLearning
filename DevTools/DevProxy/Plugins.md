# Plugin

A plugin in Dev Proxy is a .NET class that adds specific behaviors to the tool. There are three types of plugins:

1. **Intercepting Plugins**: Intercept and can modify requests and responses.
2. **Reporting Plugins**: Run on requests recorded by Dev Proxy.
3. **Reporters**: Generate reports from data collected by reporting plugins.

Plugins are registered in the `devproxyrc.json` file, which lists the plugins to load and their configurations. Dev Proxy includes a collection of built-in plugins and allows for custom plugin creation. 
When Dev Proxy starts, it loads the enabled plugins, providing capabilities like real-time API guidance, behavior simulation, and request analysis.

> IMPORTANT
> Plugins are executed in the order you provide in the configuration file. The first plugin in the list is the first to be executed.


## Intercepting plugins
When Dev Proxy intercepts a request that matches a URL in the `urlsToWatch` array, it invokes each intercepting plugin in the order listed in the configuration file. These plugins, inheriting from the [BaseProxyPlugin](https://github.com/microsoft/dev-proxy/blob/main/dev-proxy-abstractions/BaseProxyPlugin.cs) class, can subscribe to three events:

- **BeforeRequest**: Triggered when Dev Proxy intercepts a request.
- **BeforeResponse**: Triggered after Dev Proxy receives a response from the server.
- **AfterResponse**: Triggered after Dev Proxy sends the response to the client.

Plugins can define event handlers for these events to analyze and modify requests and responses, and output guidance messages. 
For examples: [https://github.com/microsoft/dev-proxy/tree/main/dev-proxy-plugins](https://github.com/microsoft/dev-proxy/tree/main/dev-proxy-plugins).

## Reporting plugins
Dev Proxy allows for the recording of API requests and responses, which is useful for reporting and analysis. Reporting plugins, inheriting from the `BaseReportingPlugin` class, register an event handler for the `AfterRecordingStop` event. 

When recording stops, the `AfterRecordingStop` event is triggered, and the recorded data is passed to the event handlers. Reporting plugins then analyze this data, generate a report object, and store it using the [StoreReport](https://github.com/microsoft/dev-proxy/blob/ecb4e1d56e327204f359152f7aff1057663edfe6/dev-proxy-abstractions/BaseReportingPlugin.cs#L15) method. The report object is defined by the reporting plugin.
> IMPORTANT
> Reporting plugins generate report objects, which Dev Proxy stores in memory. 
> To convert these report objects into user-readable reports, you must enable one or more reporters in the Dev Proxy configuration file.

## Reporters
Dev Proxy uses reporters to convert report objects from reporting plugins into user-readable reports. Reporters, inheriting from the [BaseReporter](https://github.com/microsoft/dev-proxy/blob/main/dev-proxy-plugins/Reporters/BaseReporter.cs) class, implement the [GetReport](https://github.com/microsoft/dev-proxy/blob/ecb4e1d56e327204f359152f7aff1057663edfe6/dev-proxy-plugins/Reporters/BaseReporter.cs#L25) method, which converts a report into a string. This string is then saved on disk with a filename following the pattern `PluginName_ReporterName.ReporterExtension`, such as `ApiCenterOnboardingPlugin_MarkdownReporter.md`. For example, the `MarkdownReporter` converts reports into Markdown files.
> IMPORTANT
> In Dev Proxy, reporters rely on report objects generated by reporting plugins. 
> You must enable reporting plugins first in the configuration file. 
> If reporters are enabled before reporting plugins, they won't have any data to report on.